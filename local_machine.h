///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//Copyright 2006 David Martin. All Rights Reserved.
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <stdlib.h>


//using namespace System;
//using namespace System::ComponentModel;
	//using namespace System::Collections;
	//using namespace System::Windows::Forms;
	//using namespace System::Data;
	//using namespace System::Drawing;
	using namespace Microsoft::Win32;
//lock functions**********************************************************************************************


void Lock_Registry_local_user()
		{
			//////////////////////////////////Lock Registry/////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
			RegistryKey ^ pRegKey60 = Registry::LocalMachine->CreateSubKey("software")->CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->CreateSubKey("policies")->CreateSubKey("system");
	pRegKey60->SetValue("disableregistrytools",1);
	pRegKey60->Close();
		 ///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}




void Lock_mmc_snap_ins_local_user()
		{
			//////////////////////////////////Lock mmc snap-ins/////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey61 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("mmc");
	 pRegKey61->SetValue("restricttopermittedsnapins",1);
	 pRegKey61->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}





void Lock_out_command_prompt_local_user()
		{
			/////////////////////////////////Lock out command prompt//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey62 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("windows");
	 pRegKey62->SetValue("disablecmd",1);
pRegKey62->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}






void Lock_out_run_local_user()
		{
			/////////////////////////////////Lock out run//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey63 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->
	 CreateSubKey("policies")->CreateSubKey("explorer");
	 pRegKey63->SetValue("NoRun",1);
	 pRegKey63->SetValue("NoDriveTypeAutoRun",1);
	 pRegKey63->SetValue("NoNetHood",1);
	 pRegKey63->SetValue("NoNetworkConnections",1);
	 pRegKey63->Close();
	 


///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}






void Lock_out_mmc_local_user()
		{
			/////////////////////////////////Lock out mmc//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey64 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("mmc");
	 pRegKey64->SetValue("RestrictAuthorMode",1);
pRegKey64->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}







void Lock_out_control_panel_local_user()
		{
			/////////////////////////////////Lock out control panel//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey65 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->
		 CreateSubKey("policies")->CreateSubKey("explorer");
	 pRegKey65->SetValue("NoControlPanel",1);
pRegKey65->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}






void Lock_out_explorer_local_user()
		{
			/////////////////////////////////Lock out welcome screen, autorun, autoupdate//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey66 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");
	 pRegKey66->SetValue("NoWelcomeScreen",1);
	pRegKey66->SetValue("NoDriveTypeAutoRun",1);
pRegKey66->SetValue("NoAutoUpdate",1);
pRegKey66->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}






void Lock_out_network_local_user()
		{
			/////////////////////////////////Lock out ipconfig and lan properties//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey67 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Network Connections");
	 pRegKey67->SetValue("NC_IpStateChecking",1);
	pRegKey67->SetValue("NC_LanProperties",1);
	pRegKey67->Close();
///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}


void Lock_out_My_computer_local_user()
		{
			/////////////////////////////////Lock out My computer properties//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey68 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");
	 pRegKey68->SetValue("NoPropertiesMyComputer",1);
	 pRegKey68->Close();

	///////////////////////////////////////////////////////////////////////////////////////
////

	
		}




void Lock_out_install1_local_user()
		{
			///////////////////////////////////////////////////////////////////////////////////

	 /////////////////////////////////Lock out install from removable media source//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey69 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey69->SetValue("DisableMedia",1);
	 pRegKey69->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}


		void Lock_out_install2_local_user()
		{
			/////////////////////////////////Always install with elevated privileges//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey70 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey70->SetValue("AlwaysInstallElevated",1);
	 pRegKey70->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
	void Lock_out_install3_local_user()
		{
			/////////////////////////////////Prohibit User Installs//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey71 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey71->SetValue("DisableUserInstalls",1);
	 pRegKey71->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			 
		}
		void Lock_out_install4_local_user()
		{
			/////////////////////////////////Enable user to patch elevated products//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey72 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey72->SetValue("AllowLockdownPatch",0);
	 pRegKey72->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
	void Lock_out_install5_local_user()
		{
			/////////////////////////////////Enable user to use media source while elevated//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey73 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey73->SetValue("AllowLockdownMedia",0);
	 pRegKey73->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
	void Lock_out_install6_local_user()
		{
			/////////////////////////////////Disable Windows Installer//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey74 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey74->SetValue("DisableMSI",1);
	 pRegKey74->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
	void Lock_out_install7_local_user()
		{
			/////////////////////////////////Enable user to browse media source while elevated//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey75 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey75->SetValue("AllowLockdownBrowse",0);
	 pRegKey75->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
		void Lock_out_install8_local_user()
		{
			/////////////////////////////////Enable user control over installs//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey76 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey76->SetValue("EnableUserControl",0);
	 pRegKey76->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
	void Lock_out_install9_local_user()
		{
			/////////////////////////////////Prohibit patching//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey77 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey77->SetValue("DisablePatch",1);
	 pRegKey77->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
		

void Lock_out_network10_local_user()
		{
			/////////////////////////////////Disable Automatic Install of Internet Explorer components//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey78 = Registry::LocalMachine->CreateSubKey("Software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows Script Host")->CreateSubKey("Settings");
	 pRegKey78->SetValue("Enabled",0);
pRegKey78->Close();

	 RegistryKey ^ pRegKey79 = Registry::LocalMachine->CreateSubKey("Software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows Script Host")->CreateSubKey("Settings");
	 pRegKey79->SetValue("Enabled",0);

	 pRegKey79->Close();
		}












		void Lock_out_IE_local_user()
		{
			/////////////////////////////////Disable Automatic Install of Internet Explorer components//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey80 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("InternetExplorer")->
		 CreateSubKey("Infodelivery")->CreateSubKey("Restrictions");

	 pRegKey80->SetValue("NoJITSetup",1);
	 pRegKey80->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}
																						



void Lock_taskbar_local_user()
		{
	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////
RegistryKey ^ pRegKey81 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");

	 pRegKey81->SetValue("NoSetTaskbar",1);
	 pRegKey81->Close();

 /////////////////////////////////////////////////////////////////////////////////////////////
 //////////////////////////////////////////////////////////////////////////////////////////////
		 
		}






//unlock functions///////////////////////////////////////////////////////////////////////

//***************************************************************************************
void unLock_Registry_local_user()
		{
			//////////////////////////////////Lock Registry/////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey60 = Registry::LocalMachine->CreateSubKey("software")->CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->CreateSubKey("policies")->CreateSubKey("system");
	pRegKey60->SetValue("disableregistrytools",0);
	pRegKey60->Close();
		 ///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

	
		}




void unLock_mmc_snap_ins_local_user()
		{
			//////////////////////////////////Lock mmc snap-ins/////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey61 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("mmc");
	 pRegKey61->SetValue("restricttopermittedsnapins",0);
	 pRegKey61->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}





void unLock_out_command_prompt_local_user()
		{
/////////////////////////////////Lock out command prompt//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey62 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("windows");
	 pRegKey62->SetValue("disablecmd",0);
pRegKey62->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}






void unLock_out_run_local_user()
		{
			/////////////////////////////////Lock out run//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey63 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->
	 CreateSubKey("policies")->CreateSubKey("explorer");
	 pRegKey63->SetValue("NoRun",0);
	 pRegKey63->SetValue("NoDriveTypeAutoRun",0);
	 pRegKey63->SetValue("NoNetHood",0);
	 pRegKey63->SetValue("NoNetworkConnections",0);
	 pRegKey63->Close();
	 
	 
		}





void unLock_out_mmc_local_user()
		{
			/////////////////////////////////Lock out mmc//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey64 = Registry::LocalMachine->CreateSubKey("software")->
	 CreateSubKey("policies")->CreateSubKey("microsoft")->CreateSubKey("mmc");
	 pRegKey64->SetValue("RestrictAuthorMode",0);
pRegKey64->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}







void unLock_out_control_panel_local_user()
		{
			/////////////////////////////////Lock out control panel//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey65 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("microsoft")->CreateSubKey("windows")->CreateSubKey("currentversion")->
		 CreateSubKey("policies")->CreateSubKey("explorer");
	 pRegKey65->SetValue("NoControlPanel",0);
pRegKey65->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}






void unLock_out_explorer_local_user()
		{
			/////////////////////////////////Lock out welcome screen, autorun, autoupdate//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey66 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");
	 pRegKey66->SetValue("NoWelcomeScreen",0);
	pRegKey66->SetValue("NoDriveTypeAutoRun",0);
pRegKey66->SetValue("NoAutoUpdate",0);
pRegKey66->Close();

///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}







void unLock_out_network_local_user()
		{
			/////////////////////////////////Lock out ipconfig and lan properties//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey67 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Network Connections");
	 pRegKey67->SetValue("NC_IpStateChecking",0);
	pRegKey67->SetValue("NC_LanProperties",0);
	pRegKey67->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}


void unLock_out_My_computer_local_user()
		{
			/////////////////////////////////Lock out My computer properties//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey68 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");
	 pRegKey68->SetValue("NoPropertiesMyComputer",0);
	 pRegKey68->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

			
		}




void unLock_out_install1_local_user()
		{
			 /////////////////////////////////Lock out install from removable media source//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey69 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey69->SetValue("DisableMedia",0);
	 pRegKey69->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}


		void unLock_out_install2_local_user()
		{
			/////////////////////////////////Always install with elevated privileges//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey70 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey70->SetValue("AlwaysInstallElevated",0);
	 pRegKey70->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		
		}
		void unLock_out_install3_local_user()
		{
			/////////////////////////////////Prohibit User Installs//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey71 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey71->SetValue("DisableUserInstalls",0);
	 pRegKey71->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install4_local_user()
		{
			/////////////////////////////////Enable user to patch elevated products//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey72 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey72->SetValue("AllowLockdownPatch",1);
	 pRegKey72->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install5_local_user()
		{
			/////////////////////////////////Enable user to use media source while elevated//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey73 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey73->SetValue("AllowLockdownMedia",1);
	 pRegKey73->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install6_local_user()
		{
			/////////////////////////////////Disable Windows Installer//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey74 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey74->SetValue("DisableMSI",0);
	 pRegKey74->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install7_local_user()
		{
			/////////////////////////////////Enable user to browse media source while elevated//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey75 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey75->SetValue("AllowLockdownBrowse",1);
	 pRegKey75->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install8_local_user()
		{
			/////////////////////////////////Enable user control over installs//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey76 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey76->SetValue("EnableUserControl",1);
	 pRegKey76->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		void unLock_out_install9_local_user()
		{
			/////////////////////////////////Prohibit patching//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey77 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("Windows")->
		 CreateSubKey("Installer");
	 pRegKey77->SetValue("DisablePatch",0);
	 pRegKey77->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}

void unLock_out_install10_local_user()
		{
			RegistryKey ^ pRegKey78 = Registry::LocalMachine->CreateSubKey("Software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows Script Host")->CreateSubKey("Settings");
	 pRegKey78->SetValue("Enabled",1);
pRegKey78->Close();

	 RegistryKey ^ pRegKey79 = Registry::LocalMachine->CreateSubKey("Software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows Script Host")->CreateSubKey("Settings");
	 pRegKey79->SetValue("Enabled",1);

	 pRegKey79->Close();

		}











		void unLock_out_IE_local_user()
		{
			/////////////////////////////////Disable Automatic Install of Internet Explorer components//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	 RegistryKey ^ pRegKey80 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Policies")->CreateSubKey("Microsoft")->CreateSubKey("InternetExplorer")->
		 CreateSubKey("Infodelivery")->CreateSubKey("Restrictions");

	 pRegKey80->SetValue("NoJITSetup",0);
	 pRegKey80->Close();

	///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

		}
		
																						

void unLock_out_taskbar_local_user()
		{
			///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////
RegistryKey ^ pRegKey81 = Registry::LocalMachine->CreateSubKey("software")->
		 CreateSubKey("Microsoft")->CreateSubKey("Windows")->CreateSubKey("CurrentVersion")->
		 CreateSubKey("Policies")->CreateSubKey("Explorer");

	 pRegKey81->SetValue("NoSetTaskbar",0);
	 pRegKey81->Close();

 /////////////////////////////////////////////////////////////////////////////////////////////
 //////////////////////////////////////////////////////////////////////////////////////////////

		}





//**********************************/reboot button///
	// System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
	//MessageBox::Show( "You must enter a name.", "Name Entry Error",
            //MessageBoxButtons::OK, MessageBoxIcon::Exclamation 
		
	

	//int i = system ("shutdown -t 00 -r");



    //return 0;

		//	 }